# maplestory_assignment1

## 실행 방법 (Docker Compose)

1. **프로젝트 루트(maple_ex) 폴더로 이동합니다.**

   ```bash
   cd maple_ex
   ```

2. **Docker Compose로 모든 서비스를 빌드 및 실행합니다.**

   ```bash
   docker compose up --build
   ```

3. **정상적으로 실행되면 아래와 같이 각 서비스가 기동됩니다.**

   - gateway_server: http://localhost:3001
   - auth_server: http://localhost:3002
   - event_server: http://localhost:3003
   - MongoDB: 내부 컨테이너에서 사용

4. **중지하려면**
   ```bash
   docker compose down
   ```

> 최초 실행 시에는 `--build` 옵션을 붙여주세요.  
> 코드 변경 후 재빌드가 필요할 때도 `--build`를 사용합니다.

---

## VS CODE 내 REST-CLIENT 사용시

1. **VS CODE 확장자 REST CLIENT 설치**

2. **gateway_server 내 gateway.http 사용**

   > MAPLE_EX/gateway_server/gateway_test/gateway.http 파일 사용

3. **실행 순서**
   1. 파일 내 1-2(유저 생성) 1-3(관리자 생성) 실행
   2. 생성 후 2-1(유저 로그인), 2-2(관리자 로그인) 후 얻은 token을 각각 tokenUser1와 tokenAdmin에 입력(여러 아이디를 사용하고 싶은 경우 tokenUser2에 추가)
   3. 생성한 유저에 3-2(캐릭터 생성) 실행을 통한 캐릭터 생성
   4. 3-3(캐릭터 레벨 및 아케인 포스 설정) 을 통한 캐릭터 조건 변경
   5. 4-2(이벤트 등록) 및 4-3 (이벤트 보상 추가 - 다회 추가 가능) 실행
   6. 5-2(보상 신청) 실행
   7. 6-1(보상 부여) 실행
   8. 6-2(내 보상 확인) 실행

---

## 개요

유저: 아이디 생성 → 로그인 → 캐릭터 생성 → 보상 요청 → 보상 내역 확인

운영자: 아이디 생성 → 로그인 → 이벤트 생성 → 보상 등록 → 보상 수여(조건 자동 확인)

- 이벤트 설계: 캐릭터 일정 레벨 달성 or 아케인포스 달성

- 조건 검증: 유저가 생성한 캐릭터의 레벨 혹은 아케인포스 등을 운영자가 등록한 수치를 충족하는 유저에게 보상 수여 가능

- 구현 중 고민: 기존 spring boot 스택 개발자로서 nestJs를 처음 접해봐서 서버 구현 및 기본 코드 구현에 긴 시간이 걸렸습니다.

- DB 특성을 살려 가변적인 EVENT DB에 보상 요청(캐릭터 정보)를 모두 담았다가 데이터를 편집하는 과정에서 너무 많은 오류가 발생했습니다. 이에 따라 보상과 이벤트를 나누어 구현했습니다.
- 이벤트 보상을 **1. 보상 아이템 리스트를 DB에 추가**, **2. [] 형태로 EVENT ITEM 에 추가** 중 운영자가 등록하고자 하는 바를 유동적으로 받아드릴 수 있게하기 위해선 2의 구조를 선택하는 것이 좋을 것이라 생각해 다음과 같이 구현했습니다. 추후 보상을 DB에 저장하여 보상 ID를 연결하는 것도 괜찮을 것으로 생각이 듭니다만 개인적으로 MongoDB에선 Data간의 연결성을 최소화 하는게 MongoDB의 장점이라 생각해 2번이 유리하다고 생각했습니다.

## 구조

### DB 구조

> USER:\
> 유저 정보 저장(유저 아이디, 비밀번호 등의 개인정보)\
> CHARACTER:\
> 유저 캐릭터 정보(캐릭터 닉네임, 레벨, 아케인포스)\
> EVENT:\
> 운영자가 등록한 이벤트(이벤트명, 서브명, 이벤트 내용, 조건, 보상 등)\
> REWARD:\
> 유저의 보상 요청 정보(참여 이벤트, 참여 캐릭터명 등)
